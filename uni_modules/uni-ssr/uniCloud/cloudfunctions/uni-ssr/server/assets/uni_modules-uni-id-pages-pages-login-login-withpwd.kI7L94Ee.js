"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("@dcloudio/uni-h5"),o=require("@dcloudio/uni-cloud"),t=require("./uni-forms.CJ4dDWzJ.js"),r=require("vue"),s=require("@dcloudio/uni-app"),a=require("./uni-forms-item.D3d2HZ7Y.js"),n=require("./uni-easyinput.C_oEcPLw.js"),l=require("./uni-captcha.5CORWJZL.js"),i=require("./uni-id-pages-agreements.9JZ6pWUW.js"),u=require("./uni-id-pages-fab-login.CMCjf1RO.js"),d=require("./login-page.mixin.BWGCa6Ap.js"),c=require("./_plugin-vue_export-helper.BDcHAK_d.js");require("./uni-icons.DF9TZjrB.js"),require("./uni-popup.B_u0Fe_N.js"),require("./uni-popup-dialog.BiXp_EP-.js"),require("@dcloudio/uni-i18n"),require("../entry-server.js"),require("vue-i18n"),require("@vue/server-renderer"),require("@dcloudio/uni-shared"),require("./store.Cv4WGu-a.js"),require("@vue/shared");const p=o.importObject("uni-id-co",{errorOptions:{type:"toast"}}),m={mixins:[d.mixin],data:()=>({password:"",username:"",captcha:"",needCaptcha:!1,focusUsername:!1,focusPassword:!1,logo:"/static/logo.png"}),onShow(){document.onkeydown=e=>{var o=e||window.event;o&&13==o.keyCode&&this.pwdLogin()}},methods:{toRetrievePwd(){let o="/uni_modules/uni-id-pages/pages/retrieve/retrieve";/^1\d{10}$/.test(this.username)&&(o+=`?phoneNumber=${this.username}`),e.navigateTo({url:o})},pwdLogin(){if(!this.password.length)return this.focusPassword=!0,e.showToast({title:"请输入密码",icon:"none",duration:3e3});if(!this.username.length)return this.focusUsername=!0,e.showToast({title:"请输入手机号/用户名/邮箱",icon:"none",duration:3e3});if(this.needCaptcha&&4!=this.captcha.length)return this.$refs.captcha.getImageCaptcha(),e.showToast({title:"请输入验证码",icon:"none",duration:3e3});if(this.needAgreements&&!this.agree)return this.$refs.agreements.popup(this.pwdLogin);let o={password:this.password,captcha:this.captcha};/^1\d{10}$/.test(this.username)?o.mobile=this.username:/@/.test(this.username)?o.email=this.username:o.username=this.username,p.login(o).then((e=>{this.loginSuccess(e)})).catch((e=>{"uni-id-captcha-required"==e.errCode?this.needCaptcha=!0:this.needCaptcha&&this.$refs.captcha.getImageCaptcha()}))},toRegister(){e.navigateTo({url:this.config.isAdmin?"/uni_modules/uni-id-pages/pages/register/register-admin":"/uni_modules/uni-id-pages/pages/register/register",fail(e){console.error(e)}})}}};const f=m.setup;m.setup=(e,o)=>{const t=r.useSSRContext();return(t.modules||(t.modules=new Set)).add("uni_modules/uni-id-pages/pages/login/login-withpwd.vue"),f?f(e,o):void 0};const h=c._export_sfc(m,[["ssrRender",function(o,d,p,m,f,h,g,C){const w=e.View,V=e.Image,x=e.Text,_=s.resolveEasycom(r.resolveDynamicComponent("uni-forms"),t.__easycom_4),N=s.resolveEasycom(r.resolveDynamicComponent("uni-forms-item"),a.__easycom_5),y=s.resolveEasycom(r.resolveDynamicComponent("uni-easyinput"),n.__easycom_6),k=s.resolveEasycom(r.resolveDynamicComponent("uni-captcha"),l.__easycom_1),v=s.resolveEasycom(r.resolveDynamicComponent("uni-id-pages-agreements"),i.__easycom_7),B=e.Button,b=s.resolveEasycom(r.resolveDynamicComponent("uni-id-pages-fab-login"),u.__easycom_9);d(c.ssrRenderComponent(w,r.mergeProps({class:"uni-content"},m),{default:r.withCtx(((e,t,s,a)=>{if(!t)return[r.createVNode(w,{class:"login-logo"},{default:r.withCtx((()=>[r.createVNode(V,{src:g.logo},null,8,["src"])])),_:1}),r.createVNode(x,{class:"title title-box"},{default:r.withCtx((()=>[r.createTextVNode("账号密码登录")])),_:1}),r.createVNode(_,null,{default:r.withCtx((()=>[r.createVNode(N,{name:"username"},{default:r.withCtx((()=>[r.createVNode(y,{focus:g.focusUsername,onBlur:e=>g.focusUsername=!1,class:"input-box",inputBorder:!1,modelValue:g.username,"onUpdate:modelValue":e=>g.username=e,placeholder:"请输入手机号/用户名/邮箱",trim:"all"},null,8,["focus","onBlur","modelValue","onUpdate:modelValue"])])),_:1}),r.createVNode(N,{name:"password"},{default:r.withCtx((()=>[r.createVNode(y,{focus:g.focusPassword,onBlur:e=>g.focusPassword=!1,class:"input-box",clearable:"",type:"password",inputBorder:!1,modelValue:g.password,"onUpdate:modelValue":e=>g.password=e,placeholder:"请输入密码",trim:"all"},null,8,["focus","onBlur","modelValue","onUpdate:modelValue"])])),_:1})])),_:1}),g.needCaptcha?(r.openBlock(),r.createBlock(k,{key:0,focus:"",ref:"captcha",scene:"login-by-pwd",modelValue:g.captcha,"onUpdate:modelValue":e=>g.captcha=e},null,8,["modelValue","onUpdate:modelValue"])):r.createCommentVNode("",!0),r.createVNode(v,{scope:"login",ref:"agreements"},null,512),r.createVNode(B,{class:"uni-btn",type:"primary",onClick:C.pwdLogin},{default:r.withCtx((()=>[r.createTextVNode("登录")])),_:1},8,["onClick"]),r.createVNode(w,{class:"link-box"},{default:r.withCtx((()=>[o.config.isAdmin?r.createCommentVNode("",!0):(r.openBlock(),r.createBlock(w,{key:0},{default:r.withCtx((()=>[r.createVNode(x,{class:"forget"},{default:r.withCtx((()=>[r.createTextVNode("忘记了？")])),_:1}),r.createVNode(x,{class:"link",onClick:C.toRetrievePwd},{default:r.withCtx((()=>[r.createTextVNode("找回密码")])),_:1},8,["onClick"])])),_:1})),r.createVNode(x,{class:"link",onClick:C.toRegister},{default:r.withCtx((()=>[r.createTextVNode(r.toDisplayString(o.config.isAdmin?"注册管理员账号":"注册账号"),1)])),_:1},8,["onClick"])])),_:1}),r.createVNode(b,{ref:"uniFabLogin"},null,512)];t(c.ssrRenderComponent(w,{class:"login-logo"},{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createVNode(V,{src:g.logo},null,8,["src"])];o(c.ssrRenderComponent(V,{src:g.logo},null,t,s))})),_:1},s,a)),t(c.ssrRenderComponent(x,{class:"title title-box"},{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createTextVNode("账号密码登录")];o("账号密码登录")})),_:1},s,a)),t(c.ssrRenderComponent(_,null,{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createVNode(N,{name:"username"},{default:r.withCtx((()=>[r.createVNode(y,{focus:g.focusUsername,onBlur:e=>g.focusUsername=!1,class:"input-box",inputBorder:!1,modelValue:g.username,"onUpdate:modelValue":e=>g.username=e,placeholder:"请输入手机号/用户名/邮箱",trim:"all"},null,8,["focus","onBlur","modelValue","onUpdate:modelValue"])])),_:1}),r.createVNode(N,{name:"password"},{default:r.withCtx((()=>[r.createVNode(y,{focus:g.focusPassword,onBlur:e=>g.focusPassword=!1,class:"input-box",clearable:"",type:"password",inputBorder:!1,modelValue:g.password,"onUpdate:modelValue":e=>g.password=e,placeholder:"请输入密码",trim:"all"},null,8,["focus","onBlur","modelValue","onUpdate:modelValue"])])),_:1})];o(c.ssrRenderComponent(N,{name:"username"},{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createVNode(y,{focus:g.focusUsername,onBlur:e=>g.focusUsername=!1,class:"input-box",inputBorder:!1,modelValue:g.username,"onUpdate:modelValue":e=>g.username=e,placeholder:"请输入手机号/用户名/邮箱",trim:"all"},null,8,["focus","onBlur","modelValue","onUpdate:modelValue"])];o(c.ssrRenderComponent(y,{focus:g.focusUsername,onBlur:e=>g.focusUsername=!1,class:"input-box",inputBorder:!1,modelValue:g.username,"onUpdate:modelValue":e=>g.username=e,placeholder:"请输入手机号/用户名/邮箱",trim:"all"},null,t,s))})),_:1},t,s)),o(c.ssrRenderComponent(N,{name:"password"},{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createVNode(y,{focus:g.focusPassword,onBlur:e=>g.focusPassword=!1,class:"input-box",clearable:"",type:"password",inputBorder:!1,modelValue:g.password,"onUpdate:modelValue":e=>g.password=e,placeholder:"请输入密码",trim:"all"},null,8,["focus","onBlur","modelValue","onUpdate:modelValue"])];o(c.ssrRenderComponent(y,{focus:g.focusPassword,onBlur:e=>g.focusPassword=!1,class:"input-box",clearable:"",type:"password",inputBorder:!1,modelValue:g.password,"onUpdate:modelValue":e=>g.password=e,placeholder:"请输入密码",trim:"all"},null,t,s))})),_:1},t,s))})),_:1},s,a)),g.needCaptcha?t(c.ssrRenderComponent(k,{focus:"",ref:"captcha",scene:"login-by-pwd",modelValue:g.captcha,"onUpdate:modelValue":e=>g.captcha=e},null,s,a)):t("\x3c!----\x3e"),t(c.ssrRenderComponent(v,{scope:"login",ref:"agreements"},null,s,a)),t(c.ssrRenderComponent(B,{class:"uni-btn",type:"primary",onClick:C.pwdLogin},{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createTextVNode("登录")];o("登录")})),_:1},s,a)),t(c.ssrRenderComponent(w,{class:"link-box"},{default:r.withCtx(((e,t,s,a)=>{if(!t)return[o.config.isAdmin?r.createCommentVNode("",!0):(r.openBlock(),r.createBlock(w,{key:0},{default:r.withCtx((()=>[r.createVNode(x,{class:"forget"},{default:r.withCtx((()=>[r.createTextVNode("忘记了？")])),_:1}),r.createVNode(x,{class:"link",onClick:C.toRetrievePwd},{default:r.withCtx((()=>[r.createTextVNode("找回密码")])),_:1},8,["onClick"])])),_:1})),r.createVNode(x,{class:"link",onClick:C.toRegister},{default:r.withCtx((()=>[r.createTextVNode(r.toDisplayString(o.config.isAdmin?"注册管理员账号":"注册账号"),1)])),_:1},8,["onClick"])];o.config.isAdmin?t("\x3c!----\x3e"):t(c.ssrRenderComponent(w,null,{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createVNode(x,{class:"forget"},{default:r.withCtx((()=>[r.createTextVNode("忘记了？")])),_:1}),r.createVNode(x,{class:"link",onClick:C.toRetrievePwd},{default:r.withCtx((()=>[r.createTextVNode("找回密码")])),_:1},8,["onClick"])];o(c.ssrRenderComponent(x,{class:"forget"},{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createTextVNode("忘记了？")];o("忘记了？")})),_:1},t,s)),o(c.ssrRenderComponent(x,{class:"link",onClick:C.toRetrievePwd},{default:r.withCtx(((e,o,t,s)=>{if(!o)return[r.createTextVNode("找回密码")];o("找回密码")})),_:1},t,s))})),_:1},s,a)),t(c.ssrRenderComponent(x,{class:"link",onClick:C.toRegister},{default:r.withCtx(((e,t,s,a)=>{if(!t)return[r.createTextVNode(r.toDisplayString(o.config.isAdmin?"注册管理员账号":"注册账号"),1)];t(`${c.ssrInterpolate(o.config.isAdmin?"注册管理员账号":"注册账号")}`)})),_:1},s,a))})),_:1},s,a)),t(c.ssrRenderComponent(b,{ref:"uniFabLogin"},null,s,a))})),_:1},p))}],["__scopeId","data-v-37e1c4f9"]]);exports.default=h;
