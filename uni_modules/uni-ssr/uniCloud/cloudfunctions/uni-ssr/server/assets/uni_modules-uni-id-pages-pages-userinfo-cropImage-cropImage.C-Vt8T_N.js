"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("@dcloudio/uni-h5"),e=require("vue"),i=require("./_plugin-vue_export-helper.BDcHAK_d.js");function o(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function s(t,e){const i=e.touches[0].clientX,o=e.touches[0].clientY;let{clipWidth:s,clipHeight:l,clipY:a,clipX:c,clipStart:n,isLockRatio:h,maxWidth:r,minWidth:p,maxHeight:d,minHeight:m}=t;r/=2,p/=2,m/=2,d/=2;let g=s,u=l,f=a,w=c,k=()=>(g=g<=r?g>=p?g:p:r,u=u<=d?u>=m?u:m:d,!(g>r||g<p||u>d||u<m)||!h);switch(u=n.height+(n.corner>1&&n.corner<4?1:-1)*(n.y-o),n.corner){case 1:if(g=n.width-n.x+i,h&&(u=g/(s/l)),!k())return;break;case 2:if(g=n.width-n.x+i,h&&(u=g/(s/l)),!k())return;f=n.clipY-(u-n.height);break;case 3:if(g=n.width+n.x-i,h&&(u=g/(s/l)),!k())return;f=n.clipY-(u-n.height),w=n.clipX-(g-n.width);break;case 4:if(g=n.width+n.x-i,h&&(u=g/(s/l)),!k())return;w=n.clipX-(g-n.width)}return{width:g,height:u,clipX:w,clipY:f}}require("@vue/shared");const l="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2024.3.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='图层_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%2030%2030'%20style='enable-background:new%200%200%2030%2030;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23606060;}%20.st1{fill:none;stroke:%23FFFFFF;stroke-width:2.4306;stroke-miterlimit:10;}%20.st2{fill:%23FFFFFF;}%20%3c/style%3e%3cg%3e%3cpath%20class='st2'%20d='M11.6,11c0.4,0.4,0.6,0.9,0.6,1.5c0,0.6-0.2,1.1-0.6,1.4c-0.4,0.4-0.9,0.6-1.5,0.6c-0.6,0-1.1-0.2-1.5-0.6%20c-0.4-0.4-0.6-0.9-0.6-1.4s0.2-1.1,0.6-1.5c0.4-0.4,0.9-0.6,1.5-0.6C10.8,10.4,11.2,10.6,11.6,11z%20M24.6,18.4V6.7H5.4v12l1.8-1.8%20c0.3-0.3,0.6-0.4,1-0.4c0.4,0,0.7,0.1,1,0.4l1.8,1.8l5.8-7c0.3-0.3,0.6-0.5,1.1-0.5c0.4,0,0.8,0.2,1.1,0.5%20C18.8,11.6,24.6,18.4,24.6,18.4z%20M25.6,5.7C25.9,6,26,6.3,26,6.7v16.1c0,0.4-0.1,0.7-0.4,1c-0.3,0.3-0.6,0.4-1,0.4H5.4%20c-0.4,0-0.7-0.1-1-0.4c-0.3-0.3-0.4-0.6-0.4-1V6.7c0-0.4,0.1-0.7,0.4-1c0.3-0.3,0.6-0.4,1-0.4h19.3C25,5.3,25.3,5.4,25.6,5.7z'/%3e%3cpath%20class='st1'%20d='M24.3,21.5H5.7c-0.2,0-0.3-0.2-0.3-0.3V7c0-0.2,0.2-0.3,0.3-0.3h18.6c0.2,0,0.3,0.2,0.3,0.3v14.2%20C24.6,21.3,24.5,21.5,24.3,21.5z'/%3e%3c/g%3e%3c/svg%3e",a="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2024.3.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='图层_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='30px'%20height='30px'%20viewBox='0%200%2030%2030'%20style='enable-background:new%200%200%2030%2030;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:none;stroke:%23FFFFFF;stroke-width:2.4306;stroke-miterlimit:10;}%20.st1{fill:%23FFFFFF;}%20%3c/style%3e%3cg%3e%3cpath%20class='st0'%20d='M17.1,24.2h-12c-0.2,0-0.3-0.2-0.3-0.3v-9.3c0-0.2,0.2-0.3,0.3-0.3h12c0.2,0,0.3,0.2,0.3,0.3v9.3%20C17.5,24.1,17.3,24.2,17.1,24.2z'/%3e%3cpath%20class='st0'%20d='M16.6,5.4c4.8,0,8.7,3.9,8.7,8.7'/%3e%3cpolyline%20class='st0'%20points='19.3,10.1%2014.9,5.6%2019.3,1.2%20'/%3e%3c/g%3e%3c/svg%3e",c={},n={name:"l-clipper",props:{value:{type:Boolean,default:!0},customStyle:{type:String},canvasId:{type:String,default:"l-clipper"},zIndex:{type:Number,default:99},imageUrl:{type:String},fileType:{type:String,default:"png"},quality:{type:Number,default:1},width:{type:Number,default:400},height:{type:Number,default:400},minWidth:{type:Number,default:200},maxWidth:{type:Number,default:600},minHeight:{type:Number,default:200},maxHeight:{type:Number,default:600},isLockWidth:{type:Boolean,default:!1},isLockHeight:{type:Boolean,default:!1},isLockRatio:{type:Boolean,default:!0},scaleRatio:{type:Number,default:1},minRatio:{type:Number,default:.5},maxRatio:{type:Number,default:2},isDisableScale:{type:Boolean,default:!1},isDisableRotate:{type:Boolean,default:!1},isLimitMove:{type:Boolean,default:!1},isShowPhotoBtn:{type:Boolean,default:!0},isShowRotateBtn:{type:Boolean,default:!0},isShowConfirmBtn:{type:Boolean,default:!0},isShowCancelBtn:{type:Boolean,default:!0},rotateAngle:{type:Number,default:90},source:{type:Object,default:()=>({album:"从相册中选择",camera:"拍照"})}},data(){return{canvasWidth:0,canvasHeight:0,clipX:0,clipY:0,clipWidth:0,clipHeight:0,animation:!1,imageWidth:0,imageHeight:0,imageTop:0,imageLeft:0,scale:1,angle:0,image:this.imageUrl,sysinfo:{},throttleTimer:null,throttleFlag:!0,timeClipCenter:null,flagClipTouch:!1,flagEndTouch:!1,clipStart:{},animationTimer:null,touchRelative:[{x:0,y:0}],hypotenuseLength:0,ctx:null}},computed:{clipStyle(){const{clipWidth:t,clipHeight:e,clipY:i,clipX:o,animation:s}=this;return`\n\t\t\twidth: ${t}px;\n\t\t\theight:${e}px;\n\t\t\ttransition-property: ${s?"":"background"};\n\t\t\tleft: ${o}px;\n\t\t\ttop: ${i}px\n\t\t\t`},imageStyle(){const{imageWidth:t,imageHeight:e,imageLeft:i,imageTop:o,animation:s,scale:l,angle:a}=this;return`\n\t\t\t\twidth: ${t?t+"px":"auto"};\n\t\t\t\theight: ${e?e+"px":"auto"};\n\t\t\t\ttransform: translate3d(${i-t/2}px, ${o-e/2}px, 0) scale(${l}) rotate(${a}deg);\n\t\t\t\ttransition-duration: ${s?.35:0}s\n\t\t\t`},clipSize(){const{clipWidth:t,clipHeight:e}=this;return{clipWidth:t,clipHeight:e}},clipPoint(){const{clipY:t,clipX:e}=this;return{clipY:t,clipX:e}}},watch:{value(t){if(t){if(this.imageUrl){const{imageWidth:t,imageHeight:e,imageLeft:i,imageTop:o,scale:s,clipX:l,clipY:a,clipWidth:n,clipHeight:h,path:r}=(null==c?void 0:c[this.imageUrl])||{};r!=this.image?this.image=this.imageUrl:this.setDiffData({imageWidth:t,imageHeight:e,imageLeft:i,imageTop:o,scale:s,clipX:l,clipY:a,clipWidth:n,clipHeight:h})}}else this.animation=0,this.angle=0},imageUrl(t){this.image=t},image:{handler:async function(t){this.getImageInfo(t)}},clipSize({widthVal:t,heightVal:e}){let{minWidth:i,minHeight:o}=this;i/=2,o/=2,t<i&&this.setDiffData({clipWidth:i}),e<o&&this.setDiffData({clipHeight:o}),this.calcClipSize()},angle(t){this.animation=!0,this.moveStop();const{isLimitMove:e}=this;e&&t%90&&this.setDiffData({angle:90*Math.round(t/90)}),this.imgMarginDetectionScale()},animation(t){if(clearTimeout(this.animationTimer),t){let t=setTimeout((()=>{this.setDiffData({animation:!1})}),260);this.setDiffData({animationTimer:t}),this.animationTimer=t}},isLimitMove(t){t&&(this.angle%90&&this.setDiffData({angle:90*Math.round(this.angle/90)}),this.imgMarginDetectionScale())},clipPoint(){this.cutDetectionPosition()},width(t,e){t!==e&&this.setDiffData({clipWidth:t/2})},height(t,e){t!==e&&this.setDiffData({clipHeight:t/2})}},mounted(){const e=t.getSystemInfoSync();this.sysinfo=e,this.setClipInfo(),this.image&&this.getImageInfo(this.image),this.setClipCenter(),this.calcClipSize(),this.cutDetectionPosition()},methods:{setDiffData(t){Object.keys(t).forEach((e=>{this[e]!==t[e]&&(this[e]=t[e])}))},getImageInfo(e){e&&(this.value&&t.showLoading({title:"请稍候...",mask:!0}),t.getImageInfo({src:e,success:t=>{this.imgComputeSize(t.width,t.height),this.image=t.path,this.isLimitMove&&(this.imgMarginDetectionScale(),this.$emit("ready",t));const{imageWidth:i,imageHeight:o,imageLeft:s,imageTop:l,scale:a,clipX:n,clipY:h,clipWidth:r,clipHeight:p}=this;c[e]=Object.assign(t,{imageWidth:i,imageHeight:o,imageLeft:s,imageTop:l,scale:a,clipX:n,clipY:h,clipWidth:r,clipHeight:p})},fail:t=>{this.imgComputeSize(),this.isLimitMove&&this.imgMarginDetectionScale()}}))},setClipInfo(){const{width:e,height:i,sysinfo:o,canvasId:s}=this,l=e/2,a=i/2,c=(o.windowHeight-a)/2,n=(o.windowWidth-l)/2,h=o.windowWidth/2,r=o.windowHeight/2;this.ctx=t.createCanvasContext(s,this),this.clipWidth=l,this.clipHeight=a,this.clipX=n,this.clipY=c,this.canvasHeight=a,this.canvasWidth=l,this.imageLeft=h,this.imageTop=r},setClipCenter(){const{sysInfo:e,clipHeight:i,clipWidth:o,imageTop:s,imageLeft:l}=this;let a=e||t.getSystemInfoSync(),c=.5*(a.windowHeight-i),n=.5*(a.windowWidth-o);this.imageTop=s-this.clipY+c,this.imageLeft=l-this.clipX+n,this.clipY=c,this.clipX=n},calcClipSize(){const{clipHeight:t,clipWidth:e,sysinfo:i,clipX:o,clipY:s}=this;e>i.windowWidth?this.setDiffData({clipWidth:i.windowWidth}):e+o>i.windowWidth&&this.setDiffData({clipX:i.windowWidth-o}),t>i.windowHeight?this.setDiffData({clipHeight:i.windowHeight}):t+s>i.windowHeight&&(this.clipY=i.windowHeight-s,this.setDiffData({clipY:i.windowHeight-s}))},cutDetectionPosition(){const{clipX:t,clipY:e,sysinfo:i,clipHeight:o,clipWidth:s}=this;let l=()=>{e<0&&this.setDiffData({clipY:0}),e>i.windowHeight-o&&this.setDiffData({clipY:i.windowHeight-o})},a=()=>{t<0&&this.setDiffData({clipX:0}),t>i.windowWidth-s&&this.setDiffData({clipX:i.windowWidth-s})};if(null===e&&null===t){let t=.5*(i.windowHeight-o),e=.5*(i.windowWidth-s);this.setDiffData({clipX:e,clipY:t})}else null!==e&&null!==t?(l(),a()):null!==e&&null===t?(l(),this.setDiffData({clipX:(i.windowWidth-s)/2})):null===e&&null!==t&&(a(),this.setDiffData({clipY:(i.windowHeight-o)/2}))},imgComputeSize(e,i){const{imageWidth:o,imageHeight:s}=function(e,i,o){let s=e,l=i,{clipWidth:a,clipHeight:c,sysinfo:n,width:h,height:r}=o;s&&l?s/l>(a||h)/(a||r)?(l=c||r,s=e/i*l):(s=a||h,l=i/e*s):(s=(n||t.getSystemInfoSync()).windowWidth,l=0);return{imageWidth:s,imageHeight:l}}(e,i,this);this.imageWidth=o,this.imageHeight=s},imgMarginDetectionScale(t){if(!this.isLimitMove)return;const e=function(t,e){e=e||t.scale;let{imageWidth:i,imageHeight:o,clipWidth:s,clipHeight:l,angle:a}=t;return a/90%2&&(i=o,o=i),i*e<s&&(e=s/i),o*e<l&&(e=Math.max(e,l/o)),e}(this,t);this.imgMarginDetectionPosition(e)},imgMarginDetectionPosition(t){if(!this.isLimitMove)return;const{scale:e,left:i,top:o}=function(t,e){let i=t.imageLeft,o=t.imageTop;e=e||t.scale;let s=t.imageWidth,l=t.imageHeight;t.angle/90%2&&(s=t.imageHeight,l=t.imageWidth);const{clipX:a,clipWidth:c,clipY:n,clipHeight:h}=t,r=t=>t*e/2,p=r(s),d=r(l);return i=a+p>=i?i:a+p,i=a+c-p<=i?i:a+c-p,o=n+d>=o?o:n+d,o=n+h-d<=o?o:n+h-d,{left:i,top:o,scale:e}}(this,t);this.setDiffData({imageLeft:i,imageTop:o,scale:e})},throttle(){this.setDiffData({throttleFlag:!0})},moveDuring(){clearTimeout(this.timeClipCenter)},moveStop(){clearTimeout(this.timeClipCenter);const t=setTimeout((()=>{this.animation||this.setDiffData({animation:!0}),this.setClipCenter()}),800);this.setDiffData({timeClipCenter:t})},clipTouchStart(e){if(e.preventDefault(),!this.image)return void t.showToast({title:"请选择图片",icon:"none",duration:3e3});const i=e.touches[0].clientX,o=e.touches[0].clientY,{clipX:s,clipY:l,clipWidth:a,clipHeight:c}=this,n=function(t,e,i,o,s,l){let a;const c=[t+i/2,e+o/2],n=[s,l];return n[0]<=c[0]&&n[1]<=c[1]?a=3:n[0]>=c[0]&&n[1]<=c[1]?a=2:n[0]<=c[0]&&n[1]>=c[1]?a=4:n[0]>=c[0]&&n[1]>=c[1]&&(a=1),a}(s,l,a,c,i,o);this.moveDuring(),n&&(this.clipStart={width:a,height:c,x:i,y:o,clipY:l,clipX:s,corner:n},this.flagClipTouch=!0,this.flagEndTouch=!0)},clipTouchMove(e){if(e.stopPropagation(),e.preventDefault(),!this.image)return void t.showToast({title:"请选择图片",icon:"none",duration:3e3});if(1!==e.touches.length)return;const{flagClipTouch:i,throttleFlag:o}=this;if(i&&o){const{isLockRatio:t,isLockHeight:i,isLockWidth:o}=this;if(t&&(o||i))return;this.setDiffData({throttleFlag:!1}),this.throttle();const l=s(this,e);if(l){const{width:t,height:e,clipX:s,clipY:a}=l;o||i?o?i||this.setDiffData({clipHeight:e,clipY:a}):this.setDiffData({clipWidth:t,clipX:s}):this.setDiffData({clipWidth:t,clipHeight:e,clipX:s,clipY:a}),this.imgMarginDetectionScale()}}},clipTouchEnd(){this.moveStop(),this.flagClipTouch=!1},imageTouchStart(t){event.preventDefault(),this.flagEndTouch=!1;const{imageLeft:e,imageTop:i}=this,s=t.touches[0].clientX,l=t.touches[0].clientY;let a=[];if(1===t.touches.length)a[0]={x:s-e,y:l-i},this.touchRelative=a;else{const c=t.touches[1].clientX,n=t.touches[1].clientY;const h=o(Math.abs(s-c),Math.abs(l-n));a=[{x:s-e,y:l-i},{x:c-e,y:n-i}],this.touchRelative=a,this.hypotenuseLength=h}},imageTouchMove(t){event.preventDefault();const{flagEndTouch:e,throttleFlag:i}=this;if(e||!i)return;const s=t.touches[0].clientX,l=t.touches[0].clientY;if(this.setDiffData({throttleFlag:!1}),this.throttle(),this.moveDuring(),1===t.touches.length){const{left:t,top:e}=function(t,e,i){return{left:e-t.touchRelative[0].x,top:i-t.touchRelative[0].y}}(this,s,l);this.setDiffData({imageLeft:t,imageTop:e}),this.imgMarginDetectionPosition()}else{const e=t.touches[1].clientX,i=t.touches[1].clientY;let a=Math.abs(s-e),c=Math.abs(l-i),n=o(a,c),h=this.scale*(n/this.hypotenuseLength);this.isDisableScale?h=1:(h=h<=this.minRatio?this.minRatio:h,h=h>=this.maxRatio?this.maxRatio:h,this.$emit("change",{width:this.imageWidth*h,height:this.imageHeight*h})),this.imgMarginDetectionScale(h),this.hypotenuseLength=Math.sqrt(Math.pow(a,2)+Math.pow(c,2)),this.scale=h}},imageTouchEnd(){this.setDiffData({flagEndTouch:!0}),this.moveStop()},uploadImage(){const e=Object.entries(this.source),i=["original","compressed"],o=({tempFilePaths:t,tempFiles:e})=>{this.image=t?t[0]:e[0].path},s=e=>{"message"!==e&&t.chooseImage({count:1,sizeType:i,sourceType:[e],success:o})};e.length>1?t.showActionSheet({itemList:e.map((t=>t[1])),success:({tapIndex:t})=>{s(e[t][0])}}):s(e[0][0])},imageReset(){const e=this.sysinfo||t.getSystemInfoSync();this.scale=1,this.angle=0,this.imageTop=e.windowHeight/2,this.imageLeft=e.windowWidth/2},imageLoad(e){this.imageReset(),t.hideLoading(),this.$emit("ready",e.detail)},rotate(e){if(this.isDisableRotate)return;if(!this.image)return void t.showToast({title:"请选择图片",icon:"none",duration:3e3});const{rotateAngle:i}=this,o=this.angle,s=e.currentTarget.dataset.type;this.angle="along"===s?o+i:o-i,this.$emit("rotate",this.angle)},confirm(){if(!this.image)return void t.showToast({title:"请选择图片",icon:"none",duration:3e3});t.showLoading({title:"加载中"});const{canvasHeight:e,canvasWidth:i,clipHeight:o,clipWidth:s,ctx:l,scale:a,imageLeft:c,imageTop:n,clipX:h,clipY:r,angle:p,scaleRatio:d,image:m,quality:g,fileType:u,type:f,canvasId:w}=this,k=()=>{const e=this.imageWidth*a*d,i=this.imageHeight*a*d,f=c-h,k=n-r;l.translate(f*d,k*d),l.rotate(p*Math.PI/180),l.drawImage(m,-e/2,-i/2,e,i),l.draw(!1,(()=>{const e=s*d,i=o*d;let l={x:0,y:0,width:e,height:i,destWidth:e,destHeight:i,canvasId:w,fileType:u,quality:g,success:e=>{a.url=e.tempFilePath,t.hideLoading(),this.$emit("success",a),this.$emit("input",!1)},fail:t=>{console.error("error",t),this.$emit("fail",t),this.$emit("input",!1)}},a={url:"",width:e,height:i};t.canvasToTempFilePath(l,this)}))};i!==s||e!==o?(this.canvasWidth=s,this.canvasHeight=o,l.draw(),this.$nextTick((()=>{setTimeout((()=>{k()}),100)}))):k()},cancel(){this.$emit("cancel",!1),this.$emit("input",!1)}}};const h=n.setup;n.setup=(t,i)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("uni_modules/uni-id-pages/pages/userinfo/cropImage/limeClipper/limeClipper.vue"),h?h(t,i):void 0};const r={components:{limeClipper:i._export_sfc(n,[["ssrRender",function(o,s,c,n,h,r,p,d){const m=t.View,g=t.Image,u=t.Canvas;s(i.ssrRenderComponent(m,e.mergeProps({class:["l-clipper",{open:h.value}],"disable-scroll":"",style:"z-index: "+h.zIndex+";"+h.customStyle},n),{default:e.withCtx(((t,s,c,n)=>{if(!s)return[e.createVNode(m,{class:"l-clipper-mask",onTouchstart:e.withModifiers(d.clipTouchStart,["stop","prevent"]),onTouchmove:e.withModifiers(d.clipTouchMove,["stop","prevent"]),onTouchend:e.withModifiers(d.clipTouchEnd,["stop","prevent"])},{default:e.withCtx((()=>[e.createVNode(m,{class:"l-clipper__content",style:d.clipStyle},{default:e.withCtx((()=>[(e.openBlock(),e.createBlock(e.Fragment,null,e.renderList([0,0,0,0],((t,i)=>e.createVNode(m,{class:"l-clipper__edge",key:i}))),64))])),_:1},8,["style"])])),_:1},8,["onTouchstart","onTouchmove","onTouchend"]),p.image?(e.openBlock(),e.createBlock(g,{key:0,class:"l-clipper-image",onError:d.imageLoad,onLoad:d.imageLoad,onTouchstart:e.withModifiers(d.imageTouchStart,["stop","prevent"]),onTouchmove:e.withModifiers(d.imageTouchMove,["stop","prevent"]),onTouchend:e.withModifiers(d.imageTouchEnd,["stop","prevent"]),src:p.image,mode:"auto"==p.imageWidth?"widthFix":"",style:d.imageStyle},null,8,["onError","onLoad","onTouchstart","onTouchmove","onTouchend","src","mode","style"])):e.createCommentVNode("",!0),e.createVNode(u,{"canvas-id":h.canvasId,id:"l-clipper","disable-scroll":"",style:"width: "+p.canvasWidth*h.scaleRatio+"px; height:"+p.canvasHeight*h.scaleRatio+"px;",class:"l-clipper-canvas"},null,8,["canvas-id","style"]),e.createVNode(m,{class:"l-clipper-tools"},{default:e.withCtx((()=>[e.createVNode(m,{class:"l-clipper-tools__btns"},{default:e.withCtx((()=>[h.isShowCancelBtn?(e.openBlock(),e.createBlock(m,{key:0,onClick:d.cancel},{default:e.withCtx((()=>[o.$slots.cancel?e.renderSlot(o.$slots,"cancel",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"cancel"},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowPhotoBtn?(e.openBlock(),e.createBlock(m,{key:1,onClick:d.uploadImage},{default:e.withCtx((()=>[o.$slots.photo?e.renderSlot(o.$slots,"photo",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:l}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowRotateBtn?(e.openBlock(),e.createBlock(m,{key:2,onClick:d.rotate},{default:e.withCtx((()=>[o.$slots.rotate?e.renderSlot(o.$slots,"rotate",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:a,"data-type":"inverse"}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowConfirmBtn?(e.openBlock(),e.createBlock(m,{key:3,onClick:d.confirm},{default:e.withCtx((()=>[o.$slots.confirm?e.renderSlot(o.$slots,"confirm",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"confirm"},{default:e.withCtx((()=>[e.createTextVNode("确定")])),_:1}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0)])),_:3}),e.renderSlot(o.$slots,"default",{},void 0,!0)])),_:3})];s(i.ssrRenderComponent(m,{class:"l-clipper-mask",onTouchstart:d.clipTouchStart,onTouchmove:d.clipTouchMove,onTouchend:d.clipTouchEnd},{default:e.withCtx(((t,o,s,l)=>{if(!o)return[e.createVNode(m,{class:"l-clipper__content",style:d.clipStyle},{default:e.withCtx((()=>[(e.openBlock(),e.createBlock(e.Fragment,null,e.renderList([0,0,0,0],((t,i)=>e.createVNode(m,{class:"l-clipper__edge",key:i}))),64))])),_:1},8,["style"])];o(i.ssrRenderComponent(m,{class:"l-clipper__content",style:d.clipStyle},{default:e.withCtx(((t,o,s,l)=>{if(!o)return[(e.openBlock(),e.createBlock(e.Fragment,null,e.renderList([0,0,0,0],((t,i)=>e.createVNode(m,{class:"l-clipper__edge",key:i}))),64))];o("\x3c!--[--\x3e"),i.ssrRenderList([0,0,0,0],((t,e)=>{o(i.ssrRenderComponent(m,{class:"l-clipper__edge",key:e},null,s,l))})),o("\x3c!--]--\x3e")})),_:1},s,l))})),_:1},c,n)),p.image?s(i.ssrRenderComponent(g,{class:"l-clipper-image",onError:d.imageLoad,onLoad:d.imageLoad,onTouchstart:d.imageTouchStart,onTouchmove:d.imageTouchMove,onTouchend:d.imageTouchEnd,src:p.image,mode:"auto"==p.imageWidth?"widthFix":"",style:d.imageStyle},null,c,n)):s("\x3c!----\x3e"),s(i.ssrRenderComponent(u,{"canvas-id":h.canvasId,id:"l-clipper","disable-scroll":"",style:"width: "+p.canvasWidth*h.scaleRatio+"px; height:"+p.canvasHeight*h.scaleRatio+"px;",class:"l-clipper-canvas"},null,c,n)),s(i.ssrRenderComponent(m,{class:"l-clipper-tools"},{default:e.withCtx(((t,s,c,n)=>{if(!s)return[e.createVNode(m,{class:"l-clipper-tools__btns"},{default:e.withCtx((()=>[h.isShowCancelBtn?(e.openBlock(),e.createBlock(m,{key:0,onClick:d.cancel},{default:e.withCtx((()=>[o.$slots.cancel?e.renderSlot(o.$slots,"cancel",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"cancel"},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowPhotoBtn?(e.openBlock(),e.createBlock(m,{key:1,onClick:d.uploadImage},{default:e.withCtx((()=>[o.$slots.photo?e.renderSlot(o.$slots,"photo",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:l}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowRotateBtn?(e.openBlock(),e.createBlock(m,{key:2,onClick:d.rotate},{default:e.withCtx((()=>[o.$slots.rotate?e.renderSlot(o.$slots,"rotate",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:a,"data-type":"inverse"}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowConfirmBtn?(e.openBlock(),e.createBlock(m,{key:3,onClick:d.confirm},{default:e.withCtx((()=>[o.$slots.confirm?e.renderSlot(o.$slots,"confirm",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"confirm"},{default:e.withCtx((()=>[e.createTextVNode("确定")])),_:1}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0)])),_:3}),e.renderSlot(o.$slots,"default",{},void 0,!0)];s(i.ssrRenderComponent(m,{class:"l-clipper-tools__btns"},{default:e.withCtx(((t,s,c,n)=>{if(!s)return[h.isShowCancelBtn?(e.openBlock(),e.createBlock(m,{key:0,onClick:d.cancel},{default:e.withCtx((()=>[o.$slots.cancel?e.renderSlot(o.$slots,"cancel",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"cancel"},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowPhotoBtn?(e.openBlock(),e.createBlock(m,{key:1,onClick:d.uploadImage},{default:e.withCtx((()=>[o.$slots.photo?e.renderSlot(o.$slots,"photo",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:l}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowRotateBtn?(e.openBlock(),e.createBlock(m,{key:2,onClick:d.rotate},{default:e.withCtx((()=>[o.$slots.rotate?e.renderSlot(o.$slots,"rotate",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:a,"data-type":"inverse"}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0),h.isShowConfirmBtn?(e.openBlock(),e.createBlock(m,{key:3,onClick:d.confirm},{default:e.withCtx((()=>[o.$slots.confirm?e.renderSlot(o.$slots,"confirm",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"confirm"},{default:e.withCtx((()=>[e.createTextVNode("确定")])),_:1}))])),_:3},8,["onClick"])):e.createCommentVNode("",!0)];h.isShowCancelBtn?s(i.ssrRenderComponent(m,{onClick:d.cancel},{default:e.withCtx(((t,s,l,a)=>{if(!s)return[o.$slots.cancel?e.renderSlot(o.$slots,"cancel",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"cancel"},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1}))];o.$slots.cancel?i.ssrRenderSlot(o.$slots,"cancel",{},null,s,l,a):s(i.ssrRenderComponent(m,{class:"cancel"},{default:e.withCtx(((t,i,o,s)=>{if(!i)return[e.createTextVNode("取消")];i("取消")})),_:1},l,a))})),_:3},c,n)):s("\x3c!----\x3e"),h.isShowPhotoBtn?s(i.ssrRenderComponent(m,{onClick:d.uploadImage},{default:e.withCtx(((t,s,a,c)=>{if(!s)return[o.$slots.photo?e.renderSlot(o.$slots,"photo",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:l}))];o.$slots.photo?i.ssrRenderSlot(o.$slots,"photo",{},null,s,a,c):s(i.ssrRenderComponent(g,{src:l},null,a,c))})),_:3},c,n)):s("\x3c!----\x3e"),h.isShowRotateBtn?s(i.ssrRenderComponent(m,{onClick:d.rotate},{default:e.withCtx(((t,s,l,c)=>{if(!s)return[o.$slots.rotate?e.renderSlot(o.$slots,"rotate",{key:0},void 0,!0):(e.openBlock(),e.createBlock(g,{key:1,src:a,"data-type":"inverse"}))];o.$slots.rotate?i.ssrRenderSlot(o.$slots,"rotate",{},null,s,l,c):s(i.ssrRenderComponent(g,{src:a,"data-type":"inverse"},null,l,c))})),_:3},c,n)):s("\x3c!----\x3e"),h.isShowConfirmBtn?s(i.ssrRenderComponent(m,{onClick:d.confirm},{default:e.withCtx(((t,s,l,a)=>{if(!s)return[o.$slots.confirm?e.renderSlot(o.$slots,"confirm",{key:0},void 0,!0):(e.openBlock(),e.createBlock(m,{key:1,class:"confirm"},{default:e.withCtx((()=>[e.createTextVNode("确定")])),_:1}))];o.$slots.confirm?i.ssrRenderSlot(o.$slots,"confirm",{},null,s,l,a):s(i.ssrRenderComponent(m,{class:"confirm"},{default:e.withCtx(((t,i,o,s)=>{if(!i)return[e.createTextVNode("确定")];i("确定")})),_:1},l,a))})),_:3},c,n)):s("\x3c!----\x3e")})),_:3},c,n)),i.ssrRenderSlot(o.$slots,"default",{},null,s,c,n)})),_:3},c,n))})),_:3},c))}],["__scopeId","data-v-592a86cd"]])},data:()=>({path:"",options:{width:600,height:600}}),onLoad({path:t,options:e}){this.path=t,e&&(this.options=JSON.parse(e))},methods:{successFn(e){this.getOpenerEventChannel().emit("success",e.url),t.navigateBack()},cancel(){t.navigateBack()}}};const p=r.setup;r.setup=(t,i)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("uni_modules/uni-id-pages/pages/userinfo/cropImage/cropImage.vue"),p?p(t,i):void 0};const d=i._export_sfc(r,[["ssrRender",function(o,s,l,a,c,n,h,r){const p=t.View,d=e.resolveComponent("limeClipper");s(i.ssrRenderComponent(p,e.mergeProps({class:"content"},a),{default:e.withCtx(((t,o,s,l)=>{if(!o)return[e.createVNode(d,{width:h.options.width,"scale-ratio":2,"is-lock-width":!1,"is-lock-height":!1,height:h.options.height,"image-url":h.path,onSuccess:r.successFn,onCancel:r.cancel},null,8,["width","height","image-url","onSuccess","onCancel"])];o(i.ssrRenderComponent(d,{width:h.options.width,"scale-ratio":2,"is-lock-width":!1,"is-lock-height":!1,height:h.options.height,"image-url":h.path,onSuccess:r.successFn,onCancel:r.cancel},null,s,l))})),_:1},l))}],["__scopeId","data-v-c2c356f4"]]);exports.default=d;
